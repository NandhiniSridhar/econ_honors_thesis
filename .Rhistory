geom_point(aes(color=Year), size=4) +
labs(title = i)
print(plot)
}
colnames(ranges)
ranges
mfi_name
mfi_names
india <- mfdata %>% filter(country == "India")
india
View(india)
#histogram of GLP or percent of GLP to female borrowers over time
#probably by country
#mfi names is unique MFI names in mfdata
india <- mfdata %>% filter(country == "India")
for(i in mfi_names){
if(i %in% india){
print(i)
}
}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(ggplot2)
setwd("/Users/NandhiniSridhar/Desktop/econ_honors_thesis/data/Microfinance")
mfdata <- read_excel("mix-market-financial-performance-dataset-in-usd.xlsx")
#View(mfdata)
country_data <- read_excel("COUNTRY_CODEBOOKmix-market-mfi-company-metadata.xlsx")
#View(country_data)
names(mfdata) <- gsub(' ', '_', names(mfdata))
names(country_data) <- gsub(' ', '_', names(country_data))
names(country_data)
ggplot(country_data, aes(x=Country)) +
geom_bar() +
theme(axis.text.x = element_text(size=5, angle = 90, vjust = 1, hjust=1))
south_asia <- c("Sri Lanka", "Bangladesh", "India", "Afghanistan", "Pakistan", "Bhutan", "Nepal", "Maldives")
country_data %>% filter(Country %in% south_asia)
mfdata['country'] <- NA
countries <- c()
enter <- c()
ifc <- c()
elsec <- c()
names <- c()
#get the countries of each bank in the mfi dataset
for (i in 1:nrow(mfdata)) {
mfi_name <- mfdata$MFI_Name[i]
enter <- enter %>% append(1)
if(mfi_name %in% country_data$MFI_Name){
ifc <- ifc %>% append(1)
country_name <- country_data$Country[country_data$MFI_Name == mfi_name]
names <- names %>% append(length(country_name))
countries <- countries %>% append(country_name)
#mfdata[i, 'country'] <- country_name
}
else{
elsec <- elsec %>% append(1)
countries <- countries %>% append("NOT FOUND")
}
}
# get rid of ones with multiple countries
names2 <- c()
for(i in 1:length(names)){
if(names[i] == 2){
names2 <- names2 %>% append(1)
cat(names[i], ": ", countries[i], "\n")
countries <- countries[-i]
}
}
#append to mfi dataset
mfdata$country <- countries
#filter to just countries in the south asia region and plot histogram of distribution
mfdata <- mfdata %>% filter(country %in% south_asia)
print(unique(mfdata$country))
ggplot(mfdata, aes(x=country)) +
geom_bar() +
theme(axis.text.x = element_text(size=10, angle = 45, vjust = 1, hjust=1))
annual <- mfdata %>% select(MFI_Name, Fiscal_Year, Period_Type, country) %>% filter(Period_Type == "ANN") %>% arrange(MFI_Name, Fiscal_Year)
annual$first <- 9999
annual$last <- 9999
#quarter <- mfdata %>% select(MFI_Name, Fiscal_Year, Period_Type, country) %>% filter(Period_Type == "QTR") %>% arrange(MFI_Name, Fiscal_Year)
#quarter$first <- 9999
#quarter$last <- 9999
mfi_names <- unique(mfdata$MFI_Name)
for(i in mfi_names){
temp <- annual %>% filter(MFI_Name == i)
#temp_qtr <- quarter %>% filter(MFI_Name == i)
first_year = min(temp$Fiscal_Year)
last_year = max(temp$Fiscal_Year)
#first_qtr = min(temp_qtr$Fiscal_Year)
#last_qtr = max(temp_qtr$Fiscal_Year)
annual$first[annual$MFI_Name == i] <- first_year
annual$last[annual$MFI_Name == i] <- last_year
#quarter$first[quarter$MFI_Name == i] <- first_qtr
#quarter$last[quarter$MFI_Name == i] <- last_qtr
}
ggplot(annual, aes(x=country)) +
geom_bar() +
theme(axis.text.x = element_text(size=10, angle = 45, vjust = 1, hjust=1))
#mfdata <- mfdata %>% drop_na(Gross_Loan_Portfolio)
#mfdata <- mfdata %>% drop_na(Number_of_active_borrowers)
ranges <- data.frame(matrix(ncol=3, nrow=0))
colnames(ranges) <- c('MFI_Name', 'Country', 'Year')
annual <- mfdata %>% filter(Period_Type == "ANN")
mfi_names <- unique(mfdata$MFI_Name)
mfdata <- mfdata %>% drop_na("MFI_Name")
mfdata <- mfdata %>% drop_na("country")
mfdata <- mfdata %>% drop_na("Fiscal_Year")
# count = 1
#country_name <- country_data$Country[country_data$MFI_Name == mfi_name]
for(i in mfi_names){
temp <- annual %>% filter(MFI_Name == i)
country <- annual$country[annual$MFI_Name == i]
country <- country[1]
first <- min(temp$Fiscal_Year)
last <- max(temp$Fiscal_Year)
#cat(i, country, first, last, "\n")
ranges[nrow(ranges) + 1, ] = c(i, country, first)
ranges[nrow(ranges) + 1, ] = c(i, country, last)
}
drop_na(ranges)
#graph year ranges for each mfi in india
#this is a dumbell plot
india <- ranges %>% filter(Country == "India")
india <- india %>%
mutate(paired = rep(1:(n()/2),each=2),
Year=factor(Year))
india <- india %>% mutate(facet_condition = ifelse(row_number() <= nrow(india)/2, 1, 2))
india %>% ggplot(aes(x= Year, y=MFI_Name)) +
geom_line(aes(group = paired))+
geom_point(aes(color=Year), size=4)
south_asia <- south_asia[-8] #remove Maldives from list since zero entries
for(i in south_asia){
cur_country <- ranges %>% filter(Country == i)
cur_country <- cur_country %>%
mutate(paired = rep(1:(n()/2),each=2),
Year=factor(Year))
cur_country <- cur_country %>% mutate(facet_condition = ifelse(row_number() <= nrow(cur_country)/2, 1, 2))
plot <- cur_country %>% ggplot(aes(x= Year, y=MFI_Name)) +
geom_line(aes(group = paired))+
geom_point(aes(color=Year), size=4) +
labs(title = i)
print(plot)
}
india
#histogram of GLP or percent of GLP to female borrowers over time
#probably by country
#mfi names is unique MFI names in mfdata
india <- mfdata %>% filter(country == "India")
for(i in mfi_names){
if(i %in% india$MFI_Name){
print(i)
}
}
#histogram of GLP or percent of GLP to female borrowers over time
#probably by country
#mfi names is unique MFI names in mfdata
india <- mfdata %>% filter(country == "India")
for(i in mfi_names){
if(i %in% india$MFI_Name){
#print(i)
plot <- india %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers, group=1)) +
geom_line() +
geom_point()
print(plot)
}
}
#histogram of GLP or percent of GLP to female borrowers over time
#probably by country
#mfi names is unique MFI names in mfdata
afghanistan <- mfdata %>% filter(country == "Afghanistan")
for(i in mfi_names){
if(i %in% afghanistan$MFI_Name){
#print(i)
plot <- afghanistan %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers, group=1)) +
geom_line() +
geom_point() +
labs(title = i)
print(plot)
}
}
View(mfdata)
View(afghanistan)
afghanistan <- mfdata %>% filter(country == "Afghanistan", Period_Type=="ANN")
View(afghanistan)
#histogram of GLP or percent of GLP to female borrowers over time
#probably by country
#mfi names is unique MFI names in mfdata
afghanistan <- mfdata %>% filter(country == "Afghanistan", Period_Type=="ANN")
for(i in mfi_names){
if(i %in% afghanistan$MFI_Name){
#print(i)
plot <- afghanistan %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers, group=1)) +
geom_line() +
geom_point() +
labs(title = i)
print(plot)
}
}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(ggplot2)
setwd("/Users/NandhiniSridhar/Desktop/econ_honors_thesis/data/Microfinance")
mfdata <- read_excel("mix-market-financial-performance-dataset-in-usd.xlsx")
#View(mfdata)
country_data <- read_excel("COUNTRY_CODEBOOKmix-market-mfi-company-metadata.xlsx")
#View(country_data)
names(mfdata) <- gsub(' ', '_', names(mfdata))
names(country_data) <- gsub(' ', '_', names(country_data))
names(country_data)
ggplot(country_data, aes(x=Country)) +
geom_bar() +
theme(axis.text.x = element_text(size=5, angle = 90, vjust = 1, hjust=1))
south_asia <- c("Sri Lanka", "Bangladesh", "India", "Afghanistan", "Pakistan", "Bhutan", "Nepal", "Maldives")
country_data %>% filter(Country %in% south_asia)
mfdata['country'] <- NA
countries <- c()
enter <- c()
ifc <- c()
elsec <- c()
names <- c()
#get the countries of each bank in the mfi dataset
for (i in 1:nrow(mfdata)) {
mfi_name <- mfdata$MFI_Name[i]
enter <- enter %>% append(1)
if(mfi_name %in% country_data$MFI_Name){
ifc <- ifc %>% append(1)
country_name <- country_data$Country[country_data$MFI_Name == mfi_name]
names <- names %>% append(length(country_name))
countries <- countries %>% append(country_name)
#mfdata[i, 'country'] <- country_name
}
else{
elsec <- elsec %>% append(1)
countries <- countries %>% append("NOT FOUND")
}
}
# get rid of ones with multiple countries
names2 <- c()
for(i in 1:length(names)){
if(names[i] == 2){
names2 <- names2 %>% append(1)
cat(names[i], ": ", countries[i], "\n")
countries <- countries[-i]
}
}
#append to mfi dataset
mfdata$country <- countries
#filter to just countries in the south asia region and plot histogram of distribution
mfdata <- mfdata %>% filter(country %in% south_asia)
print(unique(mfdata$country))
ggplot(mfdata, aes(x=country)) +
geom_bar() +
theme(axis.text.x = element_text(size=10, angle = 45, vjust = 1, hjust=1))
annual <- mfdata %>% select(MFI_Name, Fiscal_Year, Period_Type, country) %>% filter(Period_Type == "ANN") %>% arrange(MFI_Name, Fiscal_Year)
annual$first <- 9999
annual$last <- 9999
#quarter <- mfdata %>% select(MFI_Name, Fiscal_Year, Period_Type, country) %>% filter(Period_Type == "QTR") %>% arrange(MFI_Name, Fiscal_Year)
#quarter$first <- 9999
#quarter$last <- 9999
mfi_names <- unique(mfdata$MFI_Name)
for(i in mfi_names){
temp <- annual %>% filter(MFI_Name == i)
#temp_qtr <- quarter %>% filter(MFI_Name == i)
first_year = min(temp$Fiscal_Year)
last_year = max(temp$Fiscal_Year)
#first_qtr = min(temp_qtr$Fiscal_Year)
#last_qtr = max(temp_qtr$Fiscal_Year)
annual$first[annual$MFI_Name == i] <- first_year
annual$last[annual$MFI_Name == i] <- last_year
#quarter$first[quarter$MFI_Name == i] <- first_qtr
#quarter$last[quarter$MFI_Name == i] <- last_qtr
}
ggplot(annual, aes(x=country)) +
geom_bar() +
theme(axis.text.x = element_text(size=10, angle = 45, vjust = 1, hjust=1))
#mfdata <- mfdata %>% drop_na(Gross_Loan_Portfolio)
#mfdata <- mfdata %>% drop_na(Number_of_active_borrowers)
ranges <- data.frame(matrix(ncol=3, nrow=0))
colnames(ranges) <- c('MFI_Name', 'Country', 'Year')
annual <- mfdata %>% filter(Period_Type == "ANN")
mfi_names <- unique(mfdata$MFI_Name)
mfdata <- mfdata %>% drop_na("MFI_Name")
mfdata <- mfdata %>% drop_na("country")
mfdata <- mfdata %>% drop_na("Fiscal_Year")
# count = 1
#country_name <- country_data$Country[country_data$MFI_Name == mfi_name]
for(i in mfi_names){
temp <- annual %>% filter(MFI_Name == i)
country <- annual$country[annual$MFI_Name == i]
country <- country[1]
first <- min(temp$Fiscal_Year)
last <- max(temp$Fiscal_Year)
#cat(i, country, first, last, "\n")
ranges[nrow(ranges) + 1, ] = c(i, country, first)
ranges[nrow(ranges) + 1, ] = c(i, country, last)
}
drop_na(ranges)
afghanistan <- mfdata %>% filter(country == "Afghanistan", Period_Type=="ANN")
afghansitan
afghanistan
View(afghanistan)
afghanistan %>% select(MFI_Name, Fiscal_Year, Percent_of_female_borrowers) %>% arrange(MFI_Name, Fiscal_Year)
afghanistan <- afghanistan %>% drop_na()
afghanistan %>% select(MFI_Name, Fiscal_Year, Percent_of_female_borrowers) %>% arrange(MFI_Name, Fiscal_Year)
afghanistan %>% select(MFI_Name, Fiscal_Year, Percent_of_female_borrowers) %>% arrange(MFI_Name, Fiscal_Year)
afghanistan <- mfdata %>% filter(country == "Afghanistan", Period_Type=="ANN")
afghanistan <- afghanistan %>% drop_na(Percent_of_female_borrowers)
afghanistan %>% select(MFI_Name, Fiscal_Year, Percent_of_female_borrowers) %>% arrange(MFI_Name, Fiscal_Year)
afghanistan %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) %>%
geom_line() +
geom_point()
afghanistan %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line() +
geom_point()
afghanistan %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line()
afs %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line()
afs <- afghanistan %>% filter(MFI_Name == "AFS")
afs %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line()
for(i in mfi_names){
if(i %in% afghanistan$MFI_Name){
temp <- afghanistan %>% filter(MFI_Name == i)
plot <- temp %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line() +
geom_point() +
labs(title = i)
print(plot)
}
}
#histogram of GLP or percent of GLP to female borrowers over time
#probably by country
#mfi names is unique MFI names in mfdata
afghanistan <- mfdata %>% filter(country == "Afghanistan", Period_Type=="ANN")
afghanistan <- afghanistan %>% drop_na(Percent_of_female_borrowers)
afghanistan %>% select(MFI_Name, Fiscal_Year, Percent_of_female_borrowers) %>% arrange(MFI_Name, Fiscal_Year)
#afs <- afghanistan %>% filter(MFI_Name == "AFS")
#afs %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
#  geom_line()
for(j in south_asia){
j <- mfdata %>% filter(country == j, Period_Type=="ANN")
for(i in mfi_names){
if(i %in% j$MFI_Name){
temp <- j %>% filter(MFI_Name == i)
title_str <- cat(j, ": ", i)
plot <- temp %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line() +
geom_point() +
labs(title = title_str)
print(plot)
}
}
}
for(j in south_asia){
j <- mfdata %>% filter(country == j, Period_Type=="ANN")
for(i in mfi_names){
if(i %in% j$MFI_Name){
temp <- j %>% filter(MFI_Name == i)
title_str <- paste(j + ": " + i)
plot <- temp %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line() +
geom_point() +
labs(title = title_str)
print(plot)
}
}
}
#histogram of GLP or percent of GLP to female borrowers over time
#probably by country
#mfi names is unique MFI names in mfdata
afghanistan <- mfdata %>% filter(country == "Afghanistan", Period_Type=="ANN")
afghanistan <- afghanistan %>% drop_na(Percent_of_female_borrowers)
afghanistan %>% select(MFI_Name, Fiscal_Year, Percent_of_female_borrowers) %>% arrange(MFI_Name, Fiscal_Year)
#afs <- afghanistan %>% filter(MFI_Name == "AFS")
#afs %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
#  geom_line()
for(i in mfi_names){
if(i %in% afghanistan$MFI_Name){
temp <- afghanistan %>% filter(MFI_Name == i)
plot <- temp %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line() +
geom_point() +
labs(title = i)
print(plot)
}
}
south_asia
#histogram of GLP or percent of GLP to female borrowers over time
#probably by country
#mfi names is unique MFI names in mfdata
afghanistan <- mfdata %>% filter(country == "Afghanistan", Period_Type=="ANN")
afghanistan <- afghanistan %>% drop_na(Percent_of_female_borrowers)
for(i in mfi_names){
if(i %in% afghanistan$MFI_Name){
temp <- afghanistan %>% filter(MFI_Name == i)
plot <- temp %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line() +
geom_point() +
labs(title = i)
print(plot)
}
}
sri_lanka <- mfdata %>% filter(country == "Sri Lanka", Period_Type=="ANN") %>% drop_na(Percent_of_female_borrowers)
for(i in mfi_names){
if(i %in% sri_lanka$MFI_Name){
temp <- sri_lanka %>% filter(MFI_Name == i)
plot <- temp %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line() +
geom_point() +
labs(title = i)
print(plot)
}
}
#histogram of GLP or percent of GLP to female borrowers over time
#probably by country
#mfi names is unique MFI names in mfdata
afghanistan <- mfdata %>% filter(country == "Afghanistan", Period_Type=="ANN")
afghanistan <- afghanistan %>% drop_na(Percent_of_female_borrowers)
for(i in mfi_names){
if(i %in% afghanistan$MFI_Name){
temp <- afghanistan %>% filter(MFI_Name == i)
plot <- temp %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line() +
geom_point() +
labs(title = paste("Afghanistan", i))
print(plot)
}
}
sri_lanka <- mfdata %>% filter(country == "Sri Lanka", Period_Type=="ANN") %>% drop_na(Percent_of_female_borrowers)
for(i in mfi_names){
if(i %in% sri_lanka$MFI_Name){
temp <- sri_lanka %>% filter(MFI_Name == i)
plot <- temp %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line() +
geom_point() +
labs(title = paste("Sri Lanka", i))
print(plot)
}
}
south_asia
#histogram of GLP or percent of GLP to female borrowers over time
#probably by country
#mfi names is unique MFI names in mfdata
afghanistan <- mfdata %>% filter(country == "Afghanistan", Period_Type=="ANN")
afghanistan <- afghanistan %>% drop_na(Percent_of_female_borrowers)
for(i in mfi_names){
if(i %in% afghanistan$MFI_Name){
temp <- afghanistan %>% filter(MFI_Name == i)
plot <- temp %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line() +
geom_point() +
labs(title = paste("Afghanistan: ", i))
print(plot)
}
}
sri_lanka <- mfdata %>% filter(country == "Sri Lanka", Period_Type=="ANN") %>% drop_na(Percent_of_female_borrowers)
for(i in mfi_names){
if(i %in% sri_lanka$MFI_Name){
temp <- sri_lanka %>% filter(MFI_Name == i)
plot <- temp %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line() +
geom_point() +
labs(title = paste("Sri Lanka: ", i))
print(plot)
}
}
bangaladesh <- mfdata %>% filter(country == "Bangladesh", Period_Type=="ANN") %>% drop_na(Percent_of_female_borrowers)
for(i in mfi_names){
if(i %in% bangaladesh$MFI_Name){
temp <- bangaladesh %>% filter(MFI_Name == i)
plot <- temp %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line() +
geom_point() +
labs(title = paste("Bangladesh: ", i))
print(plot)
}
}
india <- mfdata %>% filter(country == "India", Period_Type=="ANN") %>% drop_na(Percent_of_female_borrowers)
for(i in mfi_names){
if(i %in% india$MFI_Name){
temp <- india %>% filter(MFI_Name == i)
plot <- temp %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line() +
geom_point() +
labs(title = paste("India: ", i))
print(plot)
}
}
pakistan <- mfdata %>% filter(country == "Pakistan", Period_Type=="ANN") %>% drop_na(Percent_of_female_borrowers)
for(i in mfi_names){
if(i %in% pakistan$MFI_Name){
temp <- pakistan %>% filter(MFI_Name == i)
plot <- temp %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line() +
geom_point() +
labs(title = paste("Pakistan: ", i))
print(plot)
}
}
nepal <- mfdata %>% filter(country == "Nepal", Period_Type=="ANN") %>% drop_na(Percent_of_female_borrowers)
for(i in mfi_names){
if(i %in% nepal$MFI_Name){
temp <- nepal %>% filter(MFI_Name == i)
plot <- temp %>% ggplot(aes(x=Fiscal_Year, y=Percent_of_female_borrowers)) +
geom_line() +
geom_point() +
labs(title = paste("Nepal: ", i))
print(plot)
}
}
